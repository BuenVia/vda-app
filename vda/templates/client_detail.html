{% extends 'base.html' %}

{% block title %}Client Details{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-white">{{ client.company_name }}</h2>


    {% if user.is_superuser %}
    <!-- Associated Users Card -->
    <div class="card bg-dark text-white my-4">
        <div class="card-header text-warning">
            Associated Users
        </div>
        <div class="card-body">
            {% if users %}
                <ul class="list-unstyled">
                    {% for user in users %}
                        <li>
                            <a href="{% url 'edit_or_delete_user' user.id %}" class="text-white">
                                {{ user.first_name }} {{ user.last_name }}
                            </a>
                            ({{ user.username }})
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No users are associated with this client.</p>
            {% endif %}
        </div>
        <div class="card-footer">
            <a href="{% url 'create_user' client.id %}" class="btn btn-primary">Add User</a>
        </div>
    </div>
    {% endif %}
    


    <!-- Staff Members Card -->
    <div class="card bg-dark text-white my-4">
        <div class="card-header text-warning">
            Staff Members
        </div>
        <div class="card-body">
            {% if staff_members %}
                <ul class="list-unstyled">
                    {% for staff in staff_members %}
                        <li>
                            <a href="{% url 'staff_profile' staff.id %}" class="text-white">
                                {{ staff.first_name }} {{ staff.last_name }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No staff members are associated with this client.</p>
            {% endif %}
        </div>
        <div class="card-footer">
            <a href="{% url 'create_staff' client.id %}" class="btn btn-primary">Add Staff Member</a>
        </div>
    </div>

    <!-- Tools and Equipment Card -->
    <div class="card bg-dark text-white my-4">
        <div class="card-header text-warning">
            Tools and Equipment
        </div>
        <div class="card-body">
            <ul class="list-unstyled">
                {% for tool in client.tools_equipment.all %}
                    <li>
                        <a href="{% url 'equipment_detail' tool.id %}" class="text-white">
                            {{ tool.make }} {{ tool.model }}
                        </a>
                        : {{ tool.description }}
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="card-footer">
            <a href="{% url 'create_tool_equipment' client.id %}" class="btn btn-primary">Add Tool/Equipment</a>
        </div>
    </div>

    <!-- Documents Card -->
    <div class="card bg-dark text-white my-4">
        <div class="card-header text-warning">
            Documents
        </div>
        <div class="card-body">
            <table class="table table-dark table-striped">
                <thead>
                    <tr>
                        <th>Document</th>
                        <th>Status</th>
                        <th>Upload Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category, document in document_status.items %}
                        <tr>
                            <td>{{ category|capfirst }}</td>
                            {% if document %}
                                <td>Uploaded</td>
                                <td>{{ document.upload_date }}</td>
                            {% else %}
                                <td>
                                    <a href="{% url 'upload_document' client.id category %}" class="text-white">
                                        Upload
                                    </a>
                                </td>
                                <td>-</td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="card-footer">
            <a href="{% url 'document_list' client.id %}" class="btn btn-primary">View All Documents</a>
        </div>
    </div>

    <!-- Back to Client List -->
    <a href="{% url 'client_list' %}" class="btn btn-secondary">Back to Client List</a>
</div>
{% endblock %}
